var version=function(e,t,n,a,l){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=r(t);const i={DATASET:"UnitDataSet",GET_CREATED_DATE:["createdDate"],GET_DATASET:["node","reverseUnitDataStructureLogicalRecords","edges",0,"node","reverseUnitDataSetUnitDataStructure","edges",0,"node"],GET_DATASETS:["node","reverseUnitDataStructureLogicalRecords","edges",0,"node","reverseUnitDataSetUnitDataStructure","edges"],GET_DESCRIPTION:["description"],GET_ID:["node","id"],GET_LOGICAL_RECORDS:{InstanceVariable:["InstanceVariableById","reverseLogicalRecordInstanceVariables","edges"],RepresentedVariable:["RepresentedVariableById","reverseInstanceVariableRepresentedVariable","edges",0,"node","reverseLogicalRecordInstanceVariables","edges"],Variable:["VariableById","reverseRepresentedVariableVariable","edges",0,"node","reverseInstanceVariableRepresentedVariable","edges",0,"node","reverseLogicalRecordInstanceVariables","edges"]},GET_NAME:["name"],GET_STATE:["dataSetState"],GET_SUBJECT_FIELD_NAME:["node","name"],GET_SUBJECT_FIELDS:{InstanceVariable:["representedVariable","variable","subjectFields","edges"],RepresentedVariable:["variable","subjectFields","edges"],Variable:["subjectFields","edges"]},GET_UNIT_TYPE:{InstanceVariable:["representedVariable","variable","unitType","name"],RepresentedVariable:["variable","unitType","name"],Variable:["unitType","name"]},GET_VALUATION:["valuation"],SEARCH:["Search","edges"],TYPE:["node","__typename"],VARIABLES:["InstanceVariable","RepresentedVariable","Variable"]},s={OPEN:l.SSB_COLORS.BLUE,INTERNAL:l.SSB_COLORS.GREEN,SHIELDED:l.SSB_COLORS.YELLOW,SENSITIVE:l.SSB_COLORS.RED},u={NAME:{en:"Name",nb:"Navn"},DESCRIPTION:{en:"Description",nb:"Beskrivelse"},STATE:{en:"State",nb:"Tilstand"},VALUATION:{en:"Valuation",nb:"Verdivurdering"},DATE_CREATED:{en:"Date created",nb:"Dato opprettet"},CURSOR:{en:"Cursor (changes)",nb:"Peker (endringer)"}},c={DATASET_RESULTS:{en:"Dataset results",nb:"Datasettresultater"},EDITED:{en:"Current results came from a previous search",nb:"Resultatene som foreligger gjelder forrige søk"},HITS:{en:"Number of hits in total",nb:"Antall treff totalt"},NEW_SEARCH:{en:"Hit 'Enter' for a new search",nb:"Trykk 'Enter' for et nytt søk"},PREVIOUS:{en:"wich was: ",nb:"som var: "},VARIABLE_DATASETS_CLOSED:{en:"Hide datasets",nb:"Skjul datasett"},VARIABLE_DATASETS_OPEN:{en:"Show datasets using this variable",nb:"Vis datasett som bruker denne variabelen"},VARIABLE_RESULTS:{en:"Variable results",nb:"Variabelresultater"}},E={CURSOR_OLDER:{en:"Cursors to older versions",nb:"Pekere til eldre versjoner"},DATASET_STATE:{en:"State",nb:"Tilstand"},DATASET_VALUATION:{en:"Valuation",nb:"Verdivurdering"},DATE_CREATED:{en:"Date created",nb:"Dato opprettet"},DESCRIPTION:{en:"Description",nb:"Beskrivelse"},NAME:{en:"Name",nb:"Navn"},SUBJECT_FIELDS:{en:"Subject fields",nb:'"Emner"'},TYPE:{en:"Type",nb:"Type"},UNIT_TYPE:{en:"Unit type",nb:"Enhetstype"},UPDATES:{en:"Times changed",nb:"Ganger endret"}},o={API_ERROR_MESSAGE:{en:"Something went wrong, check settings",nb:"Noe gikk galt, sjekk innstillingene"},EXTERNAL_GRAPHIQL:{en:"Access GraphiQL directly",nb:"Skriv Graphql spørringer direkte mot tjenesten"},HEADER:{en:"Variable search",nb:"Variabelsøk"},SEARCH:{en:"Search...",nb:"Søk..."},SEARCH_NO_RESULTS:{en:"No results found",nb:"Fant ingen resultater"},UNKOWN:"-"},g=(e,t)=>void 0===t?o.UNKOWN:l.getLocalizedGsimObjectText(e,t),S=(e,t)=>{const n=l.getNestedObject(t,i.GET_CREATED_DATE);return void 0===n?o.UNKOWN:new Date(n).toLocaleDateString(l.LANGUAGE.LOCALE[e])},T=e=>l.getNestedObject(e,i.GET_STATE),b=e=>l.getNestedObject(e,i.GET_VALUATION),m=(e,t)=>g(e,l.getNestedObject(t,i.GET_DESCRIPTION)),f=(e,t)=>g(e,l.getNestedObject(t,i.GET_NAME)),A=(e,t,n)=>{const r=l.getNestedObject(n,i.GET_SUBJECT_FIELDS[t]);return void 0===r?o.UNKOWN:r.map((t,n)=>((e,t)=>d.default.createElement(a.Label,{tag:!0,key:t,size:"large",content:e,style:{backgroundColor:l.SSB_COLORS.GREEN,borderColor:l.SSB_COLORS.GREEN,marginRight:"0.5em"}}))(g(e,l.getNestedObject(t,i.GET_SUBJECT_FIELD_NAME)),n))},R=(e,t,n)=>g(e,l.getNestedObject(n,i.GET_UNIT_TYPE[t])),D=e=>e.reduceRight((e,t)=>{let n=l.getNestedObject(t,i.GET_ID);return e[n]||(e[n]=[]),e[n].push(t),e},{}),I=e=>{const t=l.getNestedObject(e,i.SEARCH),n=D(t.filter(e=>l.getNestedObject(e,i.TYPE)===i.DATASET));return{variables:D(t.filter(e=>l.getNestedObject(e,i.TYPE)!==i.DATASET)),datasets:n}};function L({datasets:e,language:t}){return d.default.createElement(a.Table,{basic:"very"},d.default.createElement(a.Table.Header,null,d.default.createElement(a.Table.Row,null,Object.entries(u).map(([e,n])=>d.default.createElement(a.Table.HeaderCell,{key:e},n[t])))),d.default.createElement(a.Table.Body,null,Object.entries(e).map(([e,n])=>d.default.createElement(a.Table.Row,{key:e},d.default.createElement(a.Table.Cell,null,f(t,n[0].node)),d.default.createElement(a.Table.Cell,null,m(t,n[0].node)),d.default.createElement(a.Table.Cell,null,T(n[0].node)),d.default.createElement(a.Table.Cell,null,d.default.createElement("span",{style:{color:s[b(n[0].node)]}},b(n[0].node))),d.default.createElement(a.Table.Cell,null,S(t,n[0].node)),d.default.createElement(a.Table.Cell,null,`${n[0].cursor} (${n.length-1})`)))))}const _={InstanceVariable:"\n    query getDatasetsByInstanceVariable($id: ID!) {\n      InstanceVariableById(id: $id) {\n        reverseLogicalRecordInstanceVariables {edges {node {\n          reverseUnitDataStructureLogicalRecords {edges {node {\n            reverseUnitDataSetUnitDataStructure {edges {node {\n              id\n              name {languageText}\n              description {languageText}\n              createdDate\n              dataSetState\n              valuation\n            }}}\n          }}}\n        }}}\n      }\n    }\n  ",RepresentedVariable:"\n    query getDatasetsByRepresentedVariable($id: ID!) {\n      RepresentedVariableById(id: $id) {\n        reverseInstanceVariableRepresentedVariable {edges {node {\n          reverseLogicalRecordInstanceVariables {edges {node {\n            reverseUnitDataStructureLogicalRecords {edges {node {\n              reverseUnitDataSetUnitDataStructure {edges {node {\n                id\n                name {languageText}\n                description {languageText}\n                createdDate\n                dataSetState\n                valuation\n              }}}\n            }}}\n          }}}\n        }}}\n      }\n    }\n  ",Variable:"\n    query getDatasetsByVariable($id: ID!) {\n      VariableById(id: $id) {\n        reverseRepresentedVariableVariable {edges {node {\n          reverseInstanceVariableRepresentedVariable {edges {node {\n            reverseLogicalRecordInstanceVariables {edges {node {\n              reverseUnitDataStructureLogicalRecords {edges {node {\n                reverseUnitDataSetUnitDataStructure {edges {node {\n                  id\n                  name {languageText}\n                  description {languageText}\n                  createdDate\n                  dataSetState\n                  valuation\n                }}}\n              }}}\n            }}}\n          }}}\n        }}}\n      }\n    }\n  "};function O({id:e,language:r,variables:s}){const[u,g]=t.useState([]),[D,I]=t.useState(!1),{loading:L,error:O,data:p}=n.useQuery(_[s[0].node[i.TYPE[1]]],{variables:{id:e}});return t.useEffect(()=>{O||L||void 0===p||g(((e,t)=>{const n=l.getNestedObject(e,i.GET_LOGICAL_RECORDS[t]);if(Array.isArray(n))return 0!==n.filter(e=>{const t=l.getNestedObject(e,i.GET_DATASETS);return!!Array.isArray(t)&&0!==t.length}).length?n.map(e=>l.getNestedObject(e,i.GET_DATASET)).filter(e=>void 0!==e):[];return[]})(p,s[0].node[i.TYPE[1]]))},[O,L,p,s]),t.useEffect(()=>{O&&!L&&console.log(O)},[O,L]),d.default.createElement(a.Segment,{textAlign:"left"},d.default.createElement(l.InfoPopup,{text:E.UNIT_TYPE[r],trigger:d.default.createElement(a.Label,{ribbon:!0,size:"large",style:{backgroundColor:l.SSB_COLORS.BLUE,borderColor:l.SSB_COLORS.BLUE}},R(r,s[0].node[i.TYPE[1]],s[0].node))}),d.default.createElement(a.Grid,{columns:"equal"},d.default.createElement(a.Grid.Column,null,d.default.createElement(a.Divider,{hidden:!0}),d.default.createElement(a.List,{relaxed:!0},d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.TYPE[r]+": "),s[0].node[i.TYPE[1]]),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.NAME[r]+": "),f(r,s[0].node)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.DESCRIPTION[r]+": "),m(r,s[0].node)),s.length>1&&d.default.createElement(a.List.Item,null,d.default.createElement("b",null,`${E.UPDATES[r]}: ${s.length-1} `),`\n              (${E.CURSOR_OLDER[r]}:\n              ${s.map(e=>e.cursor).filter((e,t)=>0!==t).join(", ")})\n              `)),d.default.createElement(a.Divider,{hidden:!0}),d.default.createElement(l.InfoPopup,{text:E.SUBJECT_FIELDS[r],trigger:d.default.createElement(a.Container,null,A(r,s[0].node[i.TYPE[1]],s[0].node))})),d.default.createElement(a.Grid.Column,null,d.default.createElement(l.InfoPopup,{position:"left center",text:c["VARIABLE_DATASETS_"+(D?"CLOSED":"OPEN")][r],trigger:d.default.createElement(a.Label,{floating:!0,size:"large",onClick:()=>I(!D),style:{backgroundColor:l.SSB_COLORS.PURPLE,borderColor:l.SSB_COLORS.PURPLE}},d.default.createElement(a.Icon,{name:D?"minus circle":"plus circle"}))}),D?u.length>=1?u.map(e=>d.default.createElement(a.List,{key:e.id,relaxed:!0},d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.NAME[r]+": "),f(r,e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.DESCRIPTION[r]+": "),m(r,e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.DATASET_STATE[r]+": "),T(e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.DATASET_VALUATION[r]+": "),b(e)),d.default.createElement(a.List.Item,null,d.default.createElement("b",null,E.DATE_CREATED[r]+": "),S(r,e)))):o.SEARCH_NO_RESULTS[r]:null)),D&&u.length>=1&&d.default.createElement(a.Divider,{vertical:!0},d.default.createElement(a.Icon,{name:"arrow circle right"})))}return e.VariableSearch=function({restApi:e,language:r}){const[s,u]=t.useState(!1),[E,g]=t.useState(""),[S,T]=t.useState(!1),[b,m]=t.useState(""),[f,A]=t.useState([]),[R,D]=t.useState({}),[_,p]=t.useState(i.VARIABLES),[V,{loading:v,error:C,data:N}]=n.useManualQuery("\nquery textSearch($text: String!) {\n  Search(query: $text, filter: [InstanceVariable, RepresentedVariable, Variable, UnitDataSet]) {\n    edges {\n      cursor\n      node {\n        __typename\n        ... on Variable {\n          id\n          name {languageText}\n          description {languageText}\n          subjectFields {edges{node{name{languageText}}}}\n          unitType {name {languageText}}\n        }\n        ... on RepresentedVariable {\n          id\n          name {languageText}\n          description {languageText}\n          variable {\n            subjectFields {edges{node{name{languageText}}}}\n            unitType {name {languageText}} \n          }\n        }\n        ... on InstanceVariable {\n          id\n          name {languageText}\n          description {languageText}\n          representedVariable {\n            variable {\n              subjectFields {edges{node{name{languageText}}}}\n              unitType {name {languageText}} \n            }\n          }\n        }\n        ... on UnitDataSet {\n          id\n          name {languageText}\n          description {languageText}\n          createdDate\n          dataSetState\n          valuation\n        }\n      }\n    }\n  }\n}\n",{variables:{text:E}});t.useEffect(()=>{if(!C&&!v&&void 0!==N){const e=I(N);A(e.datasets),D(e.variables)}},[C,v,N]),t.useEffect(()=>{if(C&&!v){if(void 0!==N)try{const e=I(N);A(e.datasets),D(e.variables)}catch(e){console.log("Tried to extract query results from returned error but could not:"),console.log(e)}console.log(C)}},[N,C,v]);const U=i.VARIABLES.map(e=>d.default.createElement(a.Checkbox,{key:e,label:e,style:{marginRight:"2rem"},checked:_.includes(e),onClick:()=>((e,t)=>{p(e?_.filter(e=>e!==t):_.concat([t]))})(_.includes(e),e)}));return d.default.createElement(a.Segment,{basic:!0,textAlign:"center"},d.default.createElement(a.Label,{attached:"top right",style:{background:"transparent"}},d.default.createElement(l.InfoPopup,{position:"bottom right",text:o.EXTERNAL_GRAPHIQL[r],trigger:d.default.createElement("a",{href:e+"/graphiql",target:"_blank",rel:"noopener noreferrer"},d.default.createElement(a.Icon,{link:!0,size:"large",name:"external",style:{color:l.SSB_COLORS.BLUE}}))})),d.default.createElement(a.Search,{size:"huge",open:!1,loading:v,value:E,placeholder:o.SEARCH[r],onKeyPress:({key:e})=>"Enter"===e&&(u(!0),T(!1),m(E),void V()),onSearchChange:(e,{value:t})=>{T(!0),g(t)}}),s&&S&&d.default.createElement(l.InfoText,{text:c.EDITED[r]}),s&&S&&""!==b&&d.default.createElement(d.default.Fragment,null," (",d.default.createElement("i",null,c.PREVIOUS[r]),"'",d.default.createElement("b",null,b),"')",d.default.createElement("p",null,c.NEW_SEARCH[r])),d.default.createElement(a.Divider,{hidden:!0}),d.default.createElement(a.Grid,{columns:"equal"},d.default.createElement(a.Grid.Column,null,d.default.createElement(a.Header,{size:"huge",content:c.DATASET_RESULTS[r]}),v?d.default.createElement(a.Loader,{active:!0,inline:"centered"}):Object.keys(f).length>=1?d.default.createElement(L,{datasets:f,language:r}):s?o.SEARCH_NO_RESULTS[r]:null),d.default.createElement(a.Grid.Column,null,d.default.createElement(a.Header,{size:"huge",content:c.VARIABLE_RESULTS[r]}),U,Object.keys(R).length>=1&&`${c.HITS[r]}: ${Object.keys(R).length}`,d.default.createElement(a.Divider,{hidden:!0}),v?d.default.createElement(a.Loader,{active:!0,inline:"centered"}):Object.keys(R).length>=1?Object.entries(R).filter(e=>_.includes(e[1][0].node[i.TYPE[1]])).map(([e,t])=>d.default.createElement(O,{key:e,id:e,language:r,variables:t})):s?o.SEARCH_NO_RESULTS[r]:null)))},e}({},React,graphqlHooks,semanticUiReact,daplaJsUtilities);
