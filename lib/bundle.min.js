var version=function(e,t,a,n,l){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=r(t);const d="description",u="instanceVariable",c="instanceVariables",s="logicalRecords",o="name",g="representedVariable",m="variable",E={DATASET_TYPES:["unitDataSet"],VARIABLE_TYPES:["instanceVariable","representedVariable","variable"]},f="lineageDataset",b={LF_IV:"reverseLineageFieldInstanceVariable",IV_RV:"reverseInstanceVariableRepresentedVariable",RV_V:"reverseRepresentedVariableVariable",UDS_L:"reverseUnitDataSetLineage"},S="smart",T=(l.SSB_COLORS.BLUE,l.SSB_COLORS.GREEN,l.SSB_COLORS.YELLOW,l.SSB_COLORS.RED,{DATA_SOURCE_PATH:{en:"Data source path",nb:"Datasti"},DESCRIPTION:{en:"Description",nb:"Beskrivelse"},HAVE_FILTERED:(e,t)=>({en:`Reminder that you have filtered your search, in total there are ${t} hit(s), but you are only showing ${e}`,nb:`Obs, du har filtrert søket, totalt ${t} treff, men etter filtrering vises bare ${e}`}),NAME:{en:"Name",nb:"Navn"},VARIABLE_IN_DATASETS:{en:"Variable linked in datasets",nb:"Datasett denne variabelen er koblet til"},VARIABLES_IN_DATASET:{en:"Variables linked to this dataset",nb:"Variabler koblet til dette datasettet"}}),h="datasetsAccordionToggle",p="searchDatasetToggle",y={API_ERROR_MESSAGE:{en:"Something went wrong, check settings",nb:"Noe gikk galt, sjekk innstillingene"},CONFIGURE_SEARCH:{en:"Adjust search parameters",nb:"Søkealternativer"},COPY_ID_TO_CLIPBOARD:{en:"Click to copy id to clipboard",nb:"Klikk for å kopiere id til utklippstavlen"},DATASETS:{en:"Datasets",nb:"Datasett"},EDITED:{en:"Current results are from previous search",nb:"Resultatene gjelder forrige søk"},HEADER:{en:"Variable search",nb:"Variabelsøk"},NEW_SEARCH:{en:"Hit 'Enter' for a new search",nb:"Trykk 'Enter' for et nytt søk"},NO_RESULTS:{en:"Found nothing",nb:"Fant ingenting"},OTHER:{en:"Other:",nb:"Annet:"},SEARCH:{en:"Search...",nb:"Søk..."},SEARCH_DATASETS:{en:"Search for datasets as well?",nb:"Søk etter datasett også?"},SHOW_OF_TYPE:(e,t)=>({en:`Of ${y[e][t].toLowerCase()} show me: `,nb:`Av ${y[e][t].toLowerCase()} vis meg: `}),VARIABLES:{en:"Variables",nb:"Variabler"}};function C({searchDataset:e,handleSearchDataset:t,variableTypeFilter:a,handleVariableTypeCheckbox:l,language:r}){const d=[{key:1,title:y.CONFIGURE_SEARCH[r],content:{content:i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Header,{size:"tiny",content:y.SHOW_OF_TYPE("VARIABLES",r)[r]}),i.default.createElement(n.List,null,E.VARIABLE_TYPES.map((e=>i.default.createElement(n.List.Item,{key:e},i.default.createElement(n.Checkbox,{label:e,checked:a.includes(e),onClick:()=>l(a.includes(e),e)}))))),i.default.createElement(n.Divider,{hidden:!0}),i.default.createElement(n.Header,{size:"tiny",content:y.OTHER[r]}),i.default.createElement(n.Checkbox,{toggle:!0,checked:e,label:y.SEARCH_DATASETS[r],"data-testid":p,onClick:()=>t(!e)}))}}];return i.default.createElement(n.Accordion,{defaultActiveIndex:0,panels:d,styled:!0})}function _({id:e,type:t,language:a}){return i.default.createElement(l.InfoPopup,{text:y.COPY_ID_TO_CLIPBOARD[a],trigger:i.default.createElement(n.Icon,{link:!0,fitted:!0,size:"large",name:"copy outline",style:{color:l.SSB_COLORS.BLUE},onClick:()=>{navigator.clipboard?navigator.clipboard.writeText(e).then((()=>{console.log(`Copied ${t} id to the clipboard: ${e}`)}),(e=>{console.log(e)})):console.log("Copy to clipboard not supported in your browser")}})})}function v({datasets:e,language:t}){return i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Table,{basic:"very",selectable:!0},i.default.createElement(n.Table.Header,null,i.default.createElement(n.Table.Row,null,i.default.createElement(n.Table.HeaderCell,{collapsing:!0}),i.default.createElement(n.Table.HeaderCell,null,T.NAME[t]),i.default.createElement(n.Table.HeaderCell,null,T.DESCRIPTION[t]),i.default.createElement(n.Table.HeaderCell,null,T.DATA_SOURCE_PATH[t]),i.default.createElement(n.Table.HeaderCell,null,T.VARIABLES_IN_DATASET[t]))),i.default.createElement(n.Table.Body,null,e.map((e=>{const a=Object.keys(e)[0],r=e[a],{id:d,name:u,description:o,dataSourcePath:g,unitDataStructure:m}=r,E=l.getNestedObject(m,[s]).map((e=>e[c]));return i.default.createElement(n.Table.Row,{key:d},i.default.createElement(n.Table.Cell,{textAlign:"center"},i.default.createElement(_,{id:d,type:a,language:t})),i.default.createElement(n.Table.Cell,null,l.getLocalizedGsimObjectText(t,u)),i.default.createElement(n.Table.Cell,null,l.getLocalizedGsimObjectText(t,o)),i.default.createElement(n.Table.Cell,null,g),i.default.createElement(n.Table.Cell,null,0===E.length?"-":i.default.createElement(n.List,{bulleted:!0},E.map((e=>e.map((e=>{const{id:a,name:r,description:d}=e;return i.default.createElement(n.List.Item,{key:a},l.getLocalizedGsimObjectText(t,r),i.default.createElement("br",null),i.default.createElement("i",null,l.getLocalizedGsimObjectText(t,d)))})))))))})))))}function A({language:e,filtered:t,total:a}){return i.default.createElement(i.default.Fragment,null,i.default.createElement(n.Icon,{name:"warning circle",style:{color:l.SSB_COLORS.BLUE}}),T.HAVE_FILTERED(t,a)[e],i.default.createElement(n.Divider,{hidden:!0}))}function R({dataset:e,language:t}){const{name:a,description:r}=e,u=l.getLocalizedGsimObjectText(t,a),c=l.getLocalizedGsimObjectText(t,r);return i.default.createElement(n.Modal,{style:l.SSB_STYLE,content:i.default.createElement(n.Segment,{basic:!0},i.default.createElement(n.Grid,null,Object.entries(e).map((([e,a])=>i.default.createElement(n.Grid.Row,{key:e},i.default.createElement(n.Grid.Column,{width:4},i.default.createElement("b",null,e)),i.default.createElement(n.Grid.Column,{width:12},e===o||e===d?l.getLocalizedGsimObjectText(t,a):a)))))),trigger:i.default.createElement("p",null,i.default.createElement("b",null,u),i.default.createElement("br",null),c)})}const L={instanceVariable:"\n    {\n      instanceVariable(filter: {id: $id}) {\n        id\n        reverseLineageFieldInstanceVariable {\n          id\n          smart {\n            id\n            lineageDataset {\n              id\n              reverseUnitDataSetLineage {\n                id\n                name {\n                  languageText\n                  languageCode\n                }\n                description {\n                  languageText\n                  languageCode\n                }\n                version\n                administrativeStatus\n                valuation\n                createdBy\n                lastUpdatedBy\n                metadataSourcePath\n                shortName\n                temporalityType\n                dataSetState\n                dataSourcePath\n              }\n            }\n          }\n        }\n      }\n    }\n  ",representedVariable:"\n    {\n      representedVariable(filter: {id: $id}) {\n        id\n        reverseInstanceVariableRepresentedVariable {\n          id\n          reverseLineageFieldInstanceVariable {\n            id\n            smart {\n              id\n              lineageDataset {\n                id\n                reverseUnitDataSetLineage {\n                  id\n                  name {\n                    languageText\n                    languageCode\n                  }\n                  description {\n                    languageText\n                    languageCode  \n                  }\n                  version\n                  administrativeStatus\n                  valuation\n                  createdBy\n                  lastUpdatedBy\n                  metadataSourcePath\n                  shortName\n                  temporalityType\n                  dataSetState\n                  dataSourcePath\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ",variable:"\n    {\n      variable(filter: {id: $id}) {\n        id\n        reverseRepresentedVariableVariable {\n          id\n          reverseInstanceVariableRepresentedVariable {\n            id\n            reverseLineageFieldInstanceVariable {\n              id\n              smart {\n                id\n                lineageDataset {\n                  id\n                  reverseUnitDataSetLineage {\n                    id\n                    name {\n                      languageText\n                      languageCode\n                    }\n                    description {\n                      languageText\n                      languageCode\n                    }\n                    version\n                    administrativeStatus\n                    valuation\n                    createdBy\n                    lastUpdatedBy\n                    metadataSourcePath\n                    shortName\n                    temporalityType\n                    dataSetState\n                    dataSourcePath\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  "},O=(e,t)=>e.reduce(((e,a)=>{const n=[];let l;switch(t){case u:l=a[t][b.LF_IV];break;case g:l=((e,t)=>{const a=e[t][b.IV_RV],n=[];let l=!1;return 0!==a.length&&(a.forEach((e=>e[b.LF_IV].forEach((e=>n.push(e))))),0!==n.length&&(l=n)),l})(a,t);break;case m:l=((e,t)=>{const a=e[t][b.RV_V],n=[],l=[];let r;return 0!==a.length&&(a.forEach((e=>e[b.IV_RV].forEach((e=>n.push(e))))),0!==n.length&&(n.forEach((e=>e[b.LF_IV].forEach((e=>l.push(e))))),0!==l.length&&(r=l))),r})(a,t);break;default:l=a[t][b.LF_IV]}return l&&0!==l.length&&l.forEach((e=>{const t=e[S];if(0!==t.length){const e=t.filter((e=>e[f].hasOwnProperty(b.UDS_L)&&0!==e[f][b.UDS_L].length));0!==e.length&&e.forEach((e=>{e[f][b.UDS_L].forEach((e=>n.push(e)))}))}})),n}),[]);function I({id:e,type:l,language:r}){const[d,u]=t.useState(-1),[c,s]=t.useState([]),[o,{loading:g,error:m,data:E}]=a.useManualQuery(L[l],{variables:{id:e}});t.useEffect((()=>{if(!g&&!m&&void 0!==E&&Array.isArray(E)&&0!==E.length){const e=O(E,l),t=e.filter(((e,t,a)=>a.findIndex((t=>t.id===e.id))===t));e.length!==t.length&&(console.log("Unfiltered datasets"),console.log(e)),s(t)}}),[g,m,E,l,r]);const f=[{key:1,title:{content:i.default.createElement("b",null,T.VARIABLE_IN_DATASETS[r]),"data-testid":h},content:{content:g?i.default.createElement(n.Icon,{loading:!0,name:"spinner"}):c.length>=1?i.default.createElement(n.List,{bulleted:!0,relaxed:!0,style:{padding:"0 1rem 1rem 1rem"}},c.map((e=>{const{id:t}=e;return i.default.createElement(n.List.Item,{key:t,as:"a"},i.default.createElement(R,{dataset:e,language:r}))}))):y.NO_RESULTS[r]}}];return i.default.createElement(n.Accordion,{activeIndex:d,panels:f,onTitleClick:(e,{index:t})=>{d!==t&&o(),u(d===t?-1:t)}})}function V({language:e,lineageUrl:a,variables:r,variableTypeFilter:d}){const[u,c]=t.useState(r.filter((e=>d.includes(Object.keys(e)[0]))));return t.useEffect((()=>{c(r.filter((e=>d.includes(Object.keys(e)[0]))))}),[r,d]),i.default.createElement(i.default.Fragment,null,3!==d.length&&i.default.createElement(A,{language:e,filtered:u.length,total:r.length}),u.map((t=>{const r=Object.keys(t)[0],d=t[r],{id:u,name:c,description:s}=d;return i.default.createElement(n.Segment,{key:u,raised:!0},i.default.createElement(n.Label,{ribbon:!0,color:"blue"},r),i.default.createElement(n.Label,{attached:"top right"},i.default.createElement(_,{id:u,type:r,language:e})),i.default.createElement(n.Grid,{columns:"equal"},i.default.createElement(n.Grid.Column,null,i.default.createElement(n.Divider,{hidden:!0,style:{marginBottom:0}}),i.default.createElement(n.Grid,null,i.default.createElement(n.Grid.Row,null,i.default.createElement(n.Grid.Column,{width:4},i.default.createElement("b",null,T.NAME[e])),i.default.createElement(n.Grid.Column,{width:12},l.getLocalizedGsimObjectText(e,c))),i.default.createElement(n.Grid.Row,null,i.default.createElement(n.Grid.Column,{width:4},i.default.createElement("b",null,T.DESCRIPTION[e])),i.default.createElement(n.Grid.Column,{width:12},l.getLocalizedGsimObjectText(e,s))))),i.default.createElement(n.Grid.Column,null,i.default.createElement(I,{id:u,type:r,language:e}))),i.default.createElement(n.Divider,{hidden:!0}),i.default.createElement("a",{href:`${a}?id=${u}&type=${r}`,target:"_blank",rel:"noopener noreferrer"},"Sporing"))})))}return e.VariableSearch=function({lineageUrl:e,language:r}){const[d,u]=t.useState(!1),[c,s]=t.useState(""),[o,g]=t.useState(!1),[m,f]=t.useState(!1),[b,S]=t.useState(""),[T,h]=t.useState([]),[p,_]=t.useState([]),[A,R]=t.useState(E.VARIABLE_TYPES),[L,{loading:O,error:I,data:x}]=a.useManualQuery("\n{\n  instanceVariable(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}]}) {\n    id\n    name {\n      languageText\n      languageCode\n    }\n    description {\n      languageText\n      languageCode\n    }\n    representedVariable {\n      id\n      name {\n        languageText\n        languageCode\n      }\n      description {\n        languageText\n        languageCode\n      }\n    }\n  }\n  representedVariable(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}]}) {\n    id\n    name {\n      languageText\n      languageCode  \n    }\n    description {\n      languageText\n      languageCode\n    }\n    variable {\n      id\n      name {\n        languageText\n        languageCode\n      }\n      description {\n        languageText\n        languageCode\n      }\n    }\n  }\n  variable(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}]}) {\n    id\n    name {\n      languageText\n      languageCode\n    }\n    description {\n      languageText\n      languageCode\n    }\n  }\n  unitDataSet(filter: {OR: [{name_every: {languageText_contains: $text}}, {description_every: {languageText_contains: $text}}, {dataSourcePath_contains: $text}]}) {\n    id\n    name {\n      languageText\n      languageCode\n    }\n    description {\n      languageText\n      languageCode\n    }\n    version\n    administrativeStatus\n    valuation\n    createdBy\n    dataSourcePath\n    lastUpdatedBy\n    metadataSourcePath\n    shortName\n    temporalityType\n    dataSetState\n    unitDataStructure {\n      logicalRecords {\n        instanceVariables {\n          id\n          name {\n            languageText\n            languageCode\n          }\n          description {\n            languageText\n            languageCode\n          }\n        }\n      }\n    }\n  }\n}\n",{variables:{text:c.trim()}});t.useEffect((()=>{if(!I&&!O&&void 0!==x){const t={variables:(e=x).filter((e=>E.VARIABLE_TYPES.some((t=>Object.getOwnPropertyNames(e).includes(t))))),datasets:e.filter((e=>E.DATASET_TYPES.some((t=>Object.getOwnPropertyNames(e).includes(t)))))};h(t.datasets),_(t.variables)}var e}),[I,O,x,r]);const D=[{menuItem:i.default.createElement(n.Menu.Item,{key:"variables"},y.VARIABLES[r],i.default.createElement(n.Label,{style:{background:l.SSB_COLORS.BLUE}},O?i.default.createElement(n.Icon,{loading:!0,name:"spinner"}):p.length)),render:()=>p.length>=1?i.default.createElement(n.Tab.Pane,{as:n.Segment,basic:!0,style:{border:"none"}},i.default.createElement(V,{language:r,lineageUrl:e,variables:p,variableTypeFilter:A})):null},{menuItem:i.default.createElement(n.Menu.Item,{key:"datasets"},y.DATASETS[r],i.default.createElement(n.Label,{style:{background:l.SSB_COLORS.BLUE}},O?i.default.createElement(n.Icon,{loading:!0,name:"spinner"}):T.length)),render:()=>T.length>=1?i.default.createElement(n.Tab.Pane,{as:n.Segment,basic:!0,style:{border:"none"}},i.default.createElement(v,{language:r,datasets:T})):null}];return i.default.createElement(n.Grid,null,i.default.createElement(n.Grid.Column,{width:3},i.default.createElement(n.Container,{textAlign:"center"},i.default.createElement(n.Search,{size:"huge",open:!1,loading:O,value:c,placeholder:y.SEARCH[r],onKeyPress:({key:e})=>"Enter"===e&&void(c.length>=1&&(u(!0),g(!1),S(c),L())),onSearchChange:(e,{value:t})=>{g(!0),s(t)}}),d&&o&&i.default.createElement(l.InfoText,{text:y.EDITED[r]}),d&&o&&""!==b&&i.default.createElement(i.default.Fragment,null," '",i.default.createElement("b",null,b),"'",i.default.createElement("p",null,y.NEW_SEARCH[r]))),i.default.createElement(n.Divider,{hidden:!0}),i.default.createElement(C,{language:r,searchDataset:m,variableTypeFilter:A,handleSearchDataset:e=>f(e),handleVariableTypeCheckbox:(e,t)=>{R(e?A.filter((e=>e!==t)):A.concat([t]))}})),i.default.createElement(n.Grid.Column,{width:13},i.default.createElement(n.Tab,{defaultActiveIndex:0,menu:{secondary:!0,pointing:!0},panes:m?D:[D.shift()]})))},Object.defineProperty(e,"__esModule",{value:!0}),e}({},React,graphqlHooks,semanticUiReact,daplaJsUtilities);
